---
title: "Climate Data Extraction Codes"
author: "Michael Madin & Kate Nelson"
date: "2022-11-10"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo= TRUE, message= FALSE, warning= FALSE, cache= FALSE)
```


# Required packages 
```{r }
library(tidyverse)
library(lme4) # for modeling linear mixed effect
library(lmerTest) # for p-values for lmer
library(sjPlot) # for printing model output
library(sjmisc) # for printing model output
library(sjlabelled) # For printing model output
library(summarytools) # For summary stats
library(sjstats) # estimate partial effect size
library(ggplot2)
library(kableExtra)
library(INLA) # For Bayesian modeling using integrated nested laplace approximations
library(tmap) #Thematic mapper
library(sf)
library(raster)
library(stars)
library(sp)
library(exactextractr) # for faster raster data extraction
library(readxl)
library(tibble) # Rearrange the columns
library(s2) # For buffering unprojected geometry
```

```{r}
# Load new study locations data
LocationsRB_sf<- readRDS("C:/Users/madin/OneDrive - Kansas State University/Madin/Landscape Data/Scripts/Locations_Nsoil.rds")

# Load stacked monthly precipitation data [January to December]
# Study years  c(2005, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016)
BrickP2005<- raster("~/R01_Course_Files/GRA/BrickP2005.tif")

BrickP2007<- raster("~/R01_Course_Files/GRA/BrickP2007.tif")

BrickP2008<- raster("~/R01_Course_Files/GRA/BrickP2008.tif")

BrickP2009<- raster("~/R01_Course_Files/GRA/BrickP2009.tif")

BrickP2010<- raster("~/R01_Course_Files/GRA/BrickP2010.tif")

BrickP2011<- raster("~/R01_Course_Files/GRA/BrickP2011.tif")

BrickP2012<- raster("~/R01_Course_Files/GRA/BrickP2012.tif")

BrickP2013<- raster("~/R01_Course_Files/GRA/BrickP2013.tif")

BrickP2014<- raster("~/R01_Course_Files/GRA/BrickP2014.tif")

BrickP2015<- raster("~/R01_Course_Files/GRA/BrickP2015.tif")

BrickP2016<- raster("~/R01_Course_Files/GRA/BrickP2016.tif")

# Load stacked monthly max temperature data [January to December]
BrickTmax2005<- raster("~/R01_Course_Files/GRA/BrickTmax2005.tif")

BrickTmax2007<- raster("~/R01_Course_Files/GRA/BrickTmax2007.tif")

BrickTmax2008<- raster("~/R01_Course_Files/GRA/BrickTmax2008.tif")

BrickTmax2009<- raster("~/R01_Course_Files/GRA/BrickTmax2009.tif")

BrickTmax2010<- raster("~/R01_Course_Files/GRA/BrickTmax2010.tif")

BrickTmax2011<- raster("~/R01_Course_Files/GRA/BrickTmax2011.tif")

BrickTmax2012<- raster("~/R01_Course_Files/GRA/BrickTmax2012.tif")

BrickTmax2013<- raster("~/R01_Course_Files/GRA/BrickTmax2013.tif")

BrickTmax2014<- raster("~/R01_Course_Files/GRA/BrickTmax2014.tif")

BrickTmax2015<- raster("~/R01_Course_Files/GRA/BrickTmax2015.tif")

BrickTmax2016<- raster("~/R01_Course_Files/GRA/BrickTmax2016.tif")

# Load stacked monthly min temperature data [January to December]
BrickTmin2005<- raster("~/R01_Course_Files/GRA/BrickTmin2005.tif")

BrickTmin2007<- raster("~/R01_Course_Files/GRA/BrickTmin2007.tif")

BrickTmin2008<- raster("~/R01_Course_Files/GRA/BrickTmin2008.tif")

BrickTmin2009<- raster("~/R01_Course_Files/GRA/BrickTmin2009.tif")

BrickTmin2010<- raster("~/R01_Course_Files/GRA/BrickTmin2010.tif")

BrickTmin2011<- raster("~/R01_Course_Files/GRA/BrickTmin2011.tif")

BrickTmin2012<- raster("~/R01_Course_Files/GRA/BrickTmin2012.tif")

BrickTmin2013<- raster("~/R01_Course_Files/GRA/BrickTmin2013.tif")

BrickTmin2014<- raster("~/R01_Course_Files/GRA/BrickTmin2014.tif")

BrickTmin2015<- raster("~/R01_Course_Files/GRA/BrickTmin2015.tif")

BrickTmin2016<- raster("~/R01_Course_Files/GRA/BrickTmin2016.tif")
```


### Create a function for Extraction
```{r eval=FALSE, include=TRUE}
# Create function for mean
Extract_Data<- function(x, y){

# Extract climate variable Using fun = mean
Extract_CDat<- exact_extract(x, y, fun = "mean", force_df = TRUE)

# Add regions of extraction

Extract_CDat<- Extract_CDat%>%
  mutate(Region= y$Region) 

## Save extracted data
return(Extract_CDat)

}
```


# Exract Annual precipitation
Precipitation in Karnataka: Kodagu region is low. But this is consistent with literature. https://www.ceicdata.com/en/india/rainfall-by-district/rainfall-karnataka-kodagu-normal 
```{r eval=FALSE, include=TRUE}
# Extract for 2005
Precip_2005<- Extract_Data(BrickP2005, LocationsRB_sf)%>%
  mutate(Year= 2005)%>% rename(Precip= mean)

# Extract for 2007
Precip_2007<- Extract_Data(BrickP2007, LocationsRB_sf)%>%
  mutate(Year= 2007)%>% rename(Precip= mean)

# Extract for 2008
Precip_2008<- Extract_Data(BrickP2008, LocationsRB_sf)%>%
  mutate(Year= 2008)%>% rename(Precip= mean)

# Extract for 2009
Precip_2009<- Extract_Data(BrickP2009, LocationsRB_sf)%>%
  mutate(Year= 2009)%>% rename(Precip= mean)

# Extract for 2010
Precip_2010<- Extract_Data(BrickP2010, LocationsRB_sf)%>%
  mutate(Year= 2010)%>% rename(Precip= mean)

# Extract for 2011
Precip_2011<- Extract_Data(BrickP2011, LocationsRB_sf)%>%
  mutate(Year= 2011)%>% rename(Precip= mean)

# Extract for 2012
Precip_2012<- Extract_Data(BrickP2012, LocationsRB_sf)%>%
  mutate(Year= 2012)%>% rename(Precip= mean)

# Extract for 2013
Precip_2013<- Extract_Data(BrickP2013, LocationsRB_sf)%>%
  mutate(Year= 2013)%>% rename(Precip= mean)

# Extract for 2014
Precip_2014<- Extract_Data(BrickP2014, LocationsRB_sf)%>%
  mutate(Year= 2014)%>% rename(Precip= mean)

# Extract for 2015
Precip_2015<- Extract_Data(BrickP2015, LocationsRB_sf)%>%
  mutate(Year= 2015)%>% rename(Precip= mean)

# Extract for 2016
Precip_2016<- Extract_Data(BrickP2016, LocationsRB_sf)%>%
  mutate(Year= 2016)%>% rename(Precip= mean)
```

# Exract Annual Max Temperature
```{r eval=FALSE, include=TRUE}
# Extract for 2005
Tmax_2005<- Extract_Data(BrickTmax2005, LocationsRB_sf)%>%
  mutate(Year= 2005)%>% rename(Tmax= mean)

# Extract for 2007
Tmax_2007<- Extract_Data(BrickTmax2007, LocationsRB_sf)%>%
  mutate(Year= 2007)%>% rename(Tmax= mean)

# Extract for 2008
Tmax_2008<- Extract_Data(BrickTmax2008, LocationsRB_sf)%>%
  mutate(Year= 2008)%>% rename(Tmax= mean)

# Extract for 2009
Tmax_2009<- Extract_Data(BrickTmax2009, LocationsRB_sf)%>%
  mutate(Year= 2009)%>% rename(Tmax= mean)

# Extract for 2010
 Tmax_2010<- Extract_Data(BrickTmax2010, LocationsRB_sf)%>%
  mutate(Year= 2010)%>% rename(Tmax= mean)

# Extract for 2011
Tmax_2011<- Extract_Data(BrickTmax2011, LocationsRB_sf)%>%
  mutate(Year= 2011)%>% rename(Tmax= mean)

# Extract for 2012
Tmax_2012<- Extract_Data(BrickTmax2012, LocationsRB_sf)%>%
  mutate(Year= 2012)%>% rename(Tmax= mean)

# Extract for 2013
Tmax_2013<- Extract_Data(BrickTmax2013, LocationsRB_sf)%>%
  mutate(Year= 2013)%>% rename(Tmax= mean)

# Extract for 2014
Tmax_2014<- Extract_Data(BrickTmax2014, LocationsRB_sf)%>%
  mutate(Year= 2014)%>% rename(Tmax= mean)

# Extract for 2015
Tmax_2015<- Extract_Data(BrickTmax2015, LocationsRB_sf)%>%
  mutate(Year= 2015)%>% rename(Tmax= mean)

# Extract for 2016
Tmax_2016<- Extract_Data(BrickTmax2016, LocationsRB_sf)%>%
  mutate(Year= 2016)%>% rename(Tmax= mean)
```


# Exract Annual Min Temperature
```{r eval=FALSE, include=TRUE}
# Extract for 2007
Tmin_2005<- Extract_Data(BrickTmin2005, LocationsRB_sf)%>%
  mutate(Year= 2005)%>% rename(Tmin= mean)

# Extract for 2007
Tmin_2007<- Extract_Data(BrickTmin2007, LocationsRB_sf)%>%
  mutate(Year= 2007)%>% rename(Tmin= mean)

# Extract for 2008
Tmin_2008<- Extract_Data(BrickTmin2008, LocationsRB_sf)%>%
  mutate(Year= 2008)%>% rename(Tmin= mean)

# Extract for 2009
Tmin_2009<- Extract_Data(BrickTmin2009, LocationsRB_sf)%>%
  mutate(Year= 2009)%>% rename(Tmin= mean)

# Extract for 2010
 Tmin_2010<- Extract_Data(BrickTmin2010, LocationsRB_sf)%>%
  mutate(Year= 2010)%>% rename(Tmin= mean)

# Extract for 2011
Tmin_2011<- Extract_Data(BrickTmin2011, LocationsRB_sf)%>%
  mutate(Year= 2011)%>% rename(Tmin= mean)

# Extract for 2012
Tmin_2012<- Extract_Data(BrickTmin2012, LocationsRB_sf)%>%
  mutate(Year= 2012)%>% rename(Tmin= mean)

# Extract for 2013
Tmin_2013<- Extract_Data(BrickTmin2013, LocationsRB_sf)%>%
  mutate(Year= 2013)%>% rename(Tmin= mean)

# Extract for 2014
Tmin_2014<- Extract_Data(BrickTmin2014, LocationsRB_sf)%>%
  mutate(Year= 2014)%>% rename(Tmin= mean)

# Extract for 2015
Tmin_2015<- Extract_Data(BrickTmin2015, LocationsRB_sf)%>%
  mutate(Year= 2015)%>% rename(Tmin= mean)

# Extract for 2016
Tmin_2016<- Extract_Data(BrickTmin2016, LocationsRB_sf)%>%
  mutate(Year= 2016)%>% rename(Tmin= mean)
```


# Calculate Annual Max of Max Temperature
```{r eval=FALSE, include=TRUE}
# Calculate for 2007
Tmaxmax2005<- calc(BrickTmax2005, fun = max)

# Calculate for 2007
Tmaxmax2007<- calc(BrickTmax2007, fun = max)

# Calculate for 2008
Tmaxmax2008<- calc(BrickTmax2008, fun = max)

# Calculate for 2009
Tmaxmax2009<- calc(BrickTmax2009, fun = max)

# Calculate for 2010
Tmaxmax2010<- calc(BrickTmax2010, fun = max)

# Calculate for 2011
Tmaxmax2011<- calc(BrickTmax2011, fun = max)

# Calculate for 2012
Tmaxmax2012<- calc(BrickTmax2012, fun = max)

# Calculate for 2013
Tmaxmax2013<- calc(BrickTmax2013, fun = max)

# Calculate for 2014
Tmaxmax2014<- calc(BrickTmax2014, fun = max)

# Calculate for 2015
Tmaxmax2015<- calc(BrickTmax2015, fun = max)

# Calculate for 2016
Tmaxmax2016<- calc(BrickTmax2016, fun = max)
```


# Calculate Annual Min of Min Temperature
```{r eval=FALSE, include=TRUE}
# Calculate for 2005
Tminmin2005<- calc(BrickTmin2005, fun = min)

# Calculate for 2007
Tminmin2007<- calc(BrickTmin2007, fun = min)

# Calculate for 2008
Tminmin2008<- calc(BrickTmin2008, fun = min)

# Calculate for 2009
Tminmin2009<- calc(BrickTmin2009, fun = min)

# Calculate for 2010
Tminmin2010<- calc(BrickTmin2010, fun = min)

# Calculate for 2011
Tminmin2011<- calc(BrickTmin2011, fun = min)

# Calculate for 2012
Tminmin2012<- calc(BrickTmin2012, fun = min)

# Calculate for 2013
Tminmin2013<- calc(BrickTmin2013, fun = min)

# Calculate for 2014
Tminmin2014<- calc(BrickTmin2014, fun = min)

# Calculate for 2015
Tminmin2015<- calc(BrickTmin2015, fun = min)

# Calculate for 2016
Tminmin2016<- calc(BrickTmin2016, fun = min)
```


# Extract for Max of Max temperature
```{r eval=FALSE, include=TRUE}
# Extract for 2005 Using fun = max 
Tmaxmax_2005<- exact_extract(Tmaxmax2005, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2005)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2007 Using fun = max 
Tmaxmax_2007<- exact_extract(Tmaxmax2007, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2007)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2008 Using fun = max 
Tmaxmax_2008<- exact_extract(Tmaxmax2008, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2008)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2009 Using fun = max 
Tmaxmax_2009<- exact_extract(Tmaxmax2009, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2009)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2010 Using fun = max 
Tmaxmax_2010<- exact_extract(Tmaxmax2010, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2010)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2011 Using fun = max 
Tmaxmax_2011<- exact_extract(Tmaxmax2011, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2011)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2012 Using fun = max 
Tmaxmax_2012<- exact_extract(Tmaxmax2012, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2012)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2013 Using fun = max 
Tmaxmax_2013<- exact_extract(Tmaxmax2013, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2013)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2014 Using fun = max 
Tmaxmax_2014<- exact_extract(Tmaxmax2014, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2014)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2015 Using fun = max 
Tmaxmax_2015<- exact_extract(Tmaxmax2015, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2015)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2016 Using fun = max 
Tmaxmax_2016<- exact_extract(Tmaxmax2016, LocationsRB_sf, fun = "max", 
                             force_df = TRUE)%>% mutate(Year= 2016)%>%
                             rename(Tmmax= max)%>% 
                             mutate(Region= LocationsRB_sf$Region)
```


# Extract for Min of Min temperature
```{r eval=FALSE, include=TRUE}
# Extract for 2005 Using fun = min 
Tminmin_2005<- exact_extract(Tminmin2005, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2005)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2007 Using fun = min 
Tminmin_2007<- exact_extract(Tminmin2007, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2007)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2008 Using fun = min 
Tminmin_2008<- exact_extract(Tminmin2008, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2008)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2009 Using fun = min 
Tminmin_2009<- exact_extract(Tminmin2009, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2009)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2010 Using fun = min 
Tminmin_2010<- exact_extract(Tminmin2010, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2010)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2011 Using fun = min 
Tminmin_2011<- exact_extract(Tminmin2011, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2011)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2012 Using fun = min 
Tminmin_2012<- exact_extract(Tminmin2012, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2012)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2013 Using fun = min 
Tminmin_2013<- exact_extract(Tminmin2013, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2013)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2014 Using fun = min 
Tminmin_2014<- exact_extract(Tminmin2014, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2014)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2015 Using fun = min 
Tminmin_2015<- exact_extract(Tminmin2015, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2015)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)

# Extract for 2016 Using fun = min 
Tminmin_2016<- exact_extract(Tminmin2016, LocationsRB_sf, fun = "min", 
                             force_df = TRUE)%>% mutate(Year= 2016)%>%
                             rename(Tmmin= min)%>% 
                             mutate(Region= LocationsRB_sf$Region)
```

# Merge data
```{r eval=FALSE, include=TRUE}

# Row bin precipitation data
Annaul_Precip<- rbind(Precip_2005, Precip_2007, Precip_2008,
                      Precip_2009,
                      Precip_2010, 
                      Precip_2011, Precip_2012, Precip_2013, Precip_2014,
                      Precip_2015, Precip_2016)%>%
                             rename(StudyYear= Year)

# Row bin Max Temperature data
Annaul_Tmax<- rbind(Tmax_2005, Tmax_2007, Tmax_2008, Tmax_2009,
                    Tmax_2010,
                    Tmax_2011,
                    Tmax_2012, Tmax_2013, Tmax_2014, Tmax_2015, Tmax_2016)%>%
                             rename(StudyYear= Year)

# Row bin Min Temperature data
Annaul_Tmin<- rbind(Tmin_2005, Tmin_2007, Tmin_2008, Tmin_2009,
                    Tmin_2010,
                    Tmin_2011,
                    Tmin_2012, Tmin_2013, Tmin_2014, Tmin_2015, Tmin_2016)%>%
                             rename(StudyYear= Year)

# Row bin Max of Max Temperature data
Annaul_Tmaxmax<- rbind(Tmaxmax_2005, Tmaxmax_2007, Tmaxmax_2008,
                       Tmaxmax_2009,
                       Tmaxmax_2010,
                       Tmaxmax_2011, Tmaxmax_2012, Tmaxmax_2013, Tmaxmax_2014,
                       Tmaxmax_2015, Tmaxmax_2016)%>%
                             rename(StudyYear= Year)

# Row bin Max of Max Temperature data
Annaul_Tminmin<- rbind(Tminmin_2005, Tminmin_2007, Tminmin_2008,
                       Tminmin_2009,
                       Tminmin_2010,
                       Tminmin_2011, Tminmin_2012, Tminmin_2013, Tminmin_2014,
                       Tminmin_2015, Tminmin_2016)%>%
                             rename(StudyYear= Year)
```

# Drop years for now
```{r eval=FALSE, include=TRUE}
# Drop columns containing years
GRA_NSoilClimD<- GRA_NSoilClimD%>%
  select(-contains('Year'))

GRA_NSoilClimD<- as.data.frame(GRA_NSoilClimD)
```

# Save data
```{r eval=FALSE, include=TRUE}
# Write to csv
write.csv(GRA_NSoilClimD, "GRA_NSoilClimD.csv")

# Write to RDS
saveRDS(GRA_NSoilClimD, "New_SoilClimD.rds")
```


# Import production data
```{r eval=FALSE, include=TRUE}
Merg_PRODR<- read_csv("~/R01_Course_Files/GRA/Merg_PROD-new.csv")%>%
  select(StudyID:POLL_IND)%>% 
  mutate(StudyYear= ifelse(Country.x== "tanzania",  2011, StudyYear),
         StudyYear= ifelse(Country.x== "Brazil",  2015, StudyYear))
```


# Merge Climate and soil data and production data
```{r eval=FALSE, include=TRUE}
# Merge precip
Merg_PRODNn<- left_join(Merg_PRODR, Annaul_Precip, 
                        by= c("StudyYear", "Region"))

# Merge Tmax
Merg_PRODNn<- left_join(Merg_PRODNn, Annaul_Tmax, 
                        by= c("StudyYear", "Region"))

# Merge Tmin
Merg_PRODNn<- left_join(Merg_PRODNn, Annaul_Tmin, 
                        by= c("StudyYear", "Region"))

# Merge Tmaxmax
Merg_PRODNn<- left_join(Merg_PRODNn, Annaul_Tmaxmax, 
                        by= c("StudyYear", "Region"))

# Merge Tminmin
Merg_PRODNn<- left_join(Merg_PRODNn, Annaul_Tminmin, 
                        by= c("StudyYear", "Region"))

# Get only soil variables
New_soilData<- LocationsRB_sf%>%
  select(Region, Tsoil_OC: Tusda_texName)

# Merge Soil data
Merg_PRODNn<- left_join(Merg_PRODNn, New_soilData, 
                        by= c("Region"))

# Drop goemetry column
Merg_PRODNn<- Merg_PRODNn[, -c(33)]
```


# Save data
```{r eval=FALSE, include=TRUE}
# Write to csv
write.csv(Merg_PRODNn, "Merg_PRODNn.csv")

# Write to RDS
saveRDS(Merg_PRODNn, "Merg_PRODNn.rds")
```

